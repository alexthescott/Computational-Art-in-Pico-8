pico-8 cartridge // http://www.pico-8.com
version 36
__lua__
-- alexthescott
-- manfred mohr's random walk
-- 22/11/3

-- new seed every day of the year 
srand(31*stat(81)+stat(82)) 

p1={7,6,135,10,138,11,139,3,131,12,140,1,129,130,128,0}
p2={7,135,10,9,15,143,142,137,14,136,8,2,130,133,128,0}
p3={7,15,143,142,14,8,136,137,9,10,135,138,11,139,12,140}

p={p1,p2,p3}
c=rnd(p)

function forward()
	v=c[1]
	del(c,v)
	c[#c+1]=v
	pal(c,1)
end

for i=1,1 do
	forward()
end



pal(c,1)

function draw_lines(lines, a_lines)
	for i=1,#lines-1 do
		line(lines[i][1],
							lines[i][2],
							lines[i+1][1],
							lines[i+1][2],
							7)
	end

	for l in all(a_lines) do
	s=l[1]
	e=l[2]
	c=l[4]
	dx=(e[1]-c[1])/5
	dy=(e[2]-c[2])/5
	if dx<0 and dx!=0 then dx-=0.8 else dx+=0.8 end
	if dy<0 and dx!=0 then dy-=0.8 else dy+=0.8 end
	c[1]+=dx
	c[2]+=dy
	if (abs(c[1]-e[1])<=1) c[1]=e[1]
	if (abs(c[2]-e[2])<=1) c[2]=e[2]
	line(s[1],s[2],c[1],c[2])
	if c[1]==e[1] and c[2]==e[2] then
			del(a_lines,l)
			add(lines,{s[1],s[2],l[3]})
			add(lines,{e[1],e[2],l[3]})
		end
	end
end

function add_line(lines, a_lines)
	dx=lines[#lines][1]
	nx=dx
	dy=lines[#lines][2]
	ny=dy
	a=4+rnd(18)/1
	if(rnd()<0.5)a*=-1
	if #lines>=2 then
		vert=lines[#lines][3]==false
	else
		vert=rnd()<0.5
	end
	if vert then
		thic=rnd()<0.1
		if dy+a<=2 then
			ny=dy-a*1.2
		elseif dy+a>=126 then
		 ny=dy-a*1.2
		else
			ny=dy+a
		end
		if thic then
			if #lines>=2 and dx>lines[#lines-1][1] then
				thic_x=-1
			else
				thic_x=1
			end
			add(a_lines,{{dx+thic_x*2,dy},{nx+thic_x*2,ny},vert,{dx,dy}})
			add(a_lines,{{dx+thic_x,dy},{nx+thic_x,ny},vert,{dx,dy}})
			add(a_lines,{{dx,dy},{nx,ny},vert,{dx,dy}})
			return true
		end
	else
		thic=rnd()<0.3
		if dx+a<=2 then
			nx=dx-a*1.2
		elseif dx+a>=126 then
		 nx=dx-a*1.2
		else
			nx=dx+a
		end
		if thic then
			if #lines>=2 and dy<lines[#lines-1][2] then
				thic_y=1
			else
				thic_y=-1
			end
		 add(a_lines,{{dx,dy+thic_y*2},{nx,ny+thic_y*2},vert,{dx,dy}})
			add(a_lines,{{dx,dy+thic_y},{nx,ny+thic_y},vert,{dx,dy}})
			add(a_lines,{{dx,dy},{nx,ny},vert,{dx,dy}})
			return true
		end
	end
	add(a_lines,{{dx,dy},{nx,ny},vert,{dx,dy}})
end

function delete_line(lines)
	if #lines<=1 then
		del(lines,lines[#lines])
		return true
	end
	del(lines,lines[#lines])
	return false
end

mohr_lines={{2+rnd(124)\1,2+rnd(124)\1}}
animating_lines={}
add_line(mohr_lines)
t=0
reverse=128
reset_state=false
_set_fps(60)
cls(0)
::_::

if btn(❎) then
	cls(0)
else
	for i=0,768 do
		x=rnd(128)
		y=rnd(128)
		if abs(x-64)<=1 and abs(y-64)<=1 then
			pset(x,y,0)
		end
		a=atan2((64-x)/128,(64-y)/128)
		x2=x-cos(a)*0.65
		y2=y-sin(a)*0.65
		pset(x2,y2,max(pget(x,y)-1,0))
	end
end

draw_lines(mohr_lines, animating_lines)
if (t)%12==0 and reset_state==false then
	add_line(mohr_lines, animating_lines)
	if (#mohr_lines>=256) then
		reset_state=true
	end
end
if reset_state==true then
	if reverse<=0 then
		if delete_line(mohr_lines) then
			reset_state=false
			reverse=128
			mohr_lines={{2+rnd(124)\1,2+rnd(124)\1}}
		end
	else
		reverse-=1
	end
end
t+=1
t%=3600
flip()
goto _
__gfx__
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777777777777777777777777777n77777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777777777a7777777777a77777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777777777777777777aa77797777777a77977777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777777797777997f7777f7af77777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777777777777777777ff97ff9fv77v7v7vfvf777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777777777a77777777vufuuuuvuuuuuuuuvvu777777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777777777797pppppppppppppppppppp777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777f7777f7p7nna99777777777777pu77777777777777777777777777777777777777777777777777777777
777777777777777777777777777777777777777777n9nfvvfv7pff7affn77777777777p777777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777ffufuuupuvuuuv777777777777p977777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777fuppppppppppppp7u777777777pff7777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777777777ff9p77f9p7pppppppp777777777puv7777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777777vup777vpup777up7p77n777777pv77777777777777777777777777777777777777777777777777777777
77777777777777777777777777777777777777777779ffp777upnp7f77p7p77a77nf77p777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777n7777777up7f7np9pnvfvpvp77v7v9vvnp777777777777777777777777777777777777777777777777777777777
7777777777777777777777777777777777777an777777up77fapfpvuvupupuuuvufvuap777777777777777777777777777777777777777777777777777777777
7777777777777777779a99777777a7777777f9aa77777upffvupupppppppppppppppppp777777777777777777777777777777777777777777777777777777777
7777777777777777777ff99f77v79fa7n9f7nv97777777pppppppppppppppppppppppa7n77777777777777777777777777777777777777777777777777777777
77777777777777777fvuuufu777uu9fuvvfvuuvuuu777777777pppppppp7p7777777p99n77777777777777777777777777777777777777777777777777777777
77777777777777779fvupppppppppppppppppppppp77777777upppppppp7p7777777pff777777777777777777777777777777777777777777777777777777777
7777777777777777a9fup77777777777777nn99ppp77777777annn777777p77u7777pv7777777777777777777777777777777777777777777777777777777777
777777777777777777fup7777777777777nnaafppp77777777979a9n7777pppppppppppppppppp77777777777777777777777777777777777777777777777777
7777777777777777nafup777777777777777fvvppp77777779ffa9nva77777777777p97777777777777777777777777777777777777777777777777777777777
777777777777777nna9vp77777777777777afvuppp77nn777fvvufuuu77777777777pfv977777777777777777777777777777777777777777777777777777777
77777777777777777fvup77777777777777a9fupppn79fa777vfppppp7777n7777n7pvf777777777777777777777777777777777777777777777777777777777
777777777777777777fvp7777777777777nnavupppn7auuvv7fupafupuu777777a77pa7n77777777777777777777777777777777777777777777777777777777
777777777777777a99vup77777777777777aavupppppppppppppppppppp7aan779nap9a777777777777777777777777777777777777777777777777777777777
7777777777777777nafvpfufvu77777777n7777pppppppppppppppppppp7799nff79pufn7nn77777777777777777777777777777777777777777777777777777
77777777777777na9fvvpppppppp77777777777pppppppppppppppppppp77ff9vvavpvfvf99a7777777777777777777777777777777777777777777777777777
7777777777777777nfvupppppppp77777777777777777777777upaa9pupv7uvvuvf9puuuv9ff7777777777777777777777777777777777777777777777777777
777777777777777779fupppppppp777777777777777777777a9up79fpvpppppppppppppppfvf7777777777777777777777777777777777777777777777777777
7777777777777777777777a9fffp777777777777777777777fvup7fvpfpffan7f9aapvvfpuffnn777777n7777777777777777777777777777777777777777777
77777777777777777777777n99vp7777777777777777777n7nnvp7vupvpvvf9fvv99puvfp9vf97777977777n7777777777777777777777777777777777777777
777777777777777777777777fvup777777777777777777n77naup7v9pup9fuvuuuufpff9pfu9auauufua9777n777777777777777777777777777777777777777
77777777777777777777777n9fvp7777777777777777777777fupuaupppppppppppppvf9ppppppppppppf9nn7777777777777777777777777777777777777777
7777777777777777777777nnnafp7777777779fff79fvupppppppppppppp77777777777777777777777pvv777777777777777777777777777777777777777777
7777777777777777777777799aup777777a9uppppppppppppppppfvupppp77777777777777777777777puvan7777777777777777777777777777777777777777
7777777777777777777777naffvp777777nnuppppppppppppppppn9fpppp77777777777777777777777pu77n7777777777777777777777777777777777777777
77777777777777777777777n9fvp77777n9fvppppppppppppppppavuppppppppppvn9a7777777777777pvf9n7777777777777777777777777777777777777777
77777777777777777777777a9fvp77777nafup7777a7vuppp9f77a9uppppfv777pu7797777777777777puvann777777777777777777777777777777777777777
777777777777777777777n7afvup77na9uppppppppppppppp77nafvupppp7fv77puaan7777777777777puvf77777777777777777777777777777777777777777
77777777777777777777777afvvpnna7vupuup77nn7777v77777a9fupppp79f77pn9a77777777777777pfff97777777777777777777777777777777777777777
7777777777777777777777n9fvvp77nnaupa9p77777777777777nnvupppp77777p77777777777777777puf9nn777777777777777777777777777777777777777
7777777777777777777777naa9fppppppppppp77777777uppppppppppppppppppp77n77777777777777pu97n7777777777777777777777777777777777777777
77777777777777777777777na9vppppppppppp77777na7upfvuuvvfupppppppppppp777777777777777pu99a7777777777777777777777777777777777777777
77777777777777777777777navuppppppppppp777777avupvv7799vfupppuvfuuuupu7pppppppppppppppppppppu777777777777777777777777777777777777
77777777777777777777777777fvanffuup777777777navp77777799upppffnvvfvpa7pu7uuua77n77upuvf9aup777a777777777777777777777777777777777
77777777777777777777777777777na9vvp777777777a9fp77777nn9upppann7a99pu9puvff9vn77777puf9an7pv777n77777777777777777777777777777777
77777777777777777777777777777na77up7777777777fvp77n7777avppp7aa7nnapunpuvf977777n77pv9an77pu977777777777777777777777777777777777
77777777777777777777777777777nnavup7777777779fup777777a7fpppn777777pvvpvv7777777777pvvnn77pufan777777777777777777777777777777777
777777777777777777777777777777na9up777777777n99p77777777uppp7777n77pppppppppppppppppun7777pu9a7777777777777777777777777777777777
777777777777777777777777777777navup77777pppppppppppppppppppppppppppppvpuvuuufuvun7uuva7n77puva7777777777777777777777777777777777
77777777777777777777777777777n7faup7777vpnvufvvppppppppppppppppppppppppffavffffff77aff7777pf97nn77777777777777777777777777777777
7777777777777777777777777777777favp777nup7va9a9ppppppppppppppppppppppuu9aan9a7nafa77a77777pv7aan77777777777777777777777777777777
7777777777777777777777777777777nvvp77777p9aafv7uuvfuuuuuuvuuupvufuuupan7n777777n97a7n77777pufnn777777777777777777777777777777777
77777777777777777777777777777777nfp7777up7a99f7faf7v9ffv9fvvvpf99vvvpa777777a7777a77777777pu977777777777777777777777777777777777
77777777777777777777777777777779fup7n7f9p77a979f9977nana79afapaaafffpn77777777777777777777puf77777777777777777777777777777777777
777777777777777777777777777777a7nup77af9p7a77a9n7a77779nan99npn7n999p7a7777777777777777777pv997777777777777777777777777777777777
777777777777777777777777777777nnfvp779a9p77777777n777a7777nanp77n77npnn7777777777777777777pppppppppppppppppu77777777777777777777
777777777777777777777777777777nnvuppppppp77777777777n7777777fp777777pn77777777777777777777pppppppppppppppppaa7777777777777777777
7777777777777777777777777777777f9vvuuuuu777777777777777777779p777777pvv7777777777777777777pppppppppppppppppuvfa77777777777777777
777777777777777777777777777777779f7nfv77777777777777777777777p777777pff77777777777777777777u7vufuvuuuffvv9paf7777777777777777777
7777777777777777777777777777777779779f77777777777777777777777p777777pna7777777777777777777777779nffvfv9f97puvf7n7777777777777777
7777777777777777777777777777777777777777777777ppppppppppppppppppppppp7nn77777777777777777777777aa97fa9a777p77a777777777777777777
77777777777777777777777777777777777777777na9vupvuuuvuuuuuuvuvpffvuuu97a7777777777777777777777777777777a77apu7n777777777777777777
777777777777777777777777777777777777777777a9nupvf9vfav99vvfvfp7ffva9fa7a7777777777777777777777777777777777puf9777777777777777777
77777777777777777777777uppppppppppp7777777aavupf9fffnaaaf9aa9p799fn9a9an7777777777777777777777777777777777puf9a77777777777777777
7777777777777777777777vupuauvafuuup777777777fup7777a77nn9nn9apa7n9aa9an77777777777777777777777777777777777pu99a77777777777777777
7777777777777777777777v9papppppppppppp777777fvp777777777n77anpn7nann77777777777777777777777777777777777777pu99777777777777777777
777777777777777777777f7upnpppppppppppp777777f7p77777777777n77p777n7777777777777777777777777777777777777777pppppppppppppppppuv777
777777777777777777777afvpvpppppppppppp7777779up77777777777777pppppppppppppppppppp777777777777777777777777777777fu7f9vfvuvupuf777
77777777777777777777a99upupvuvuunupuvp777777nfp77777777777777ufvuuvu7vuvuv9uuuuup7777777777777777777777777777779nv99vffa79puff97
777777777777777777777avapupvf99fnupfup777777nvp77777777777777vfaf9vfv9vavfv99nfvppppppppppppppp77777777777777799779779f977pvff9a
777777777777vupppppppppppppppppppppfvp7777777up7777777777777n9a7anffa7a7f7f9a99fppppppppppppppp77777777777777777777an7na77pva9a7
77777777779ff9pfvuuuuuuupvpufuffvuff7p7777777vp77777777777777an7n799a7n79n9aa779pppppppppppppppu7777777777777777777a777777pvf9n7
77777fuppppppppppppppppppppv9vfv979f7pppppppppppp77777777777nnn7nnaan77777ann7777uvuv9uufv9uufp77n777777777777777777n77777pfaan7
777a9vuppppppppppppppppppppa79a9a7977puuu9fuuupvp7777777777777777777777777n77777799ff99v9vavvfpu77777777777777777777777777pv9an7
77naa9vpppppppppppppppppppp77nnan777vp99vv9vvvpvp7777777777777777777777777777777777f797f99nnf9pu77777777777777777777777777pfna77
7777fafvvu7vuvppppppppppppp777777777fp977fafffp9p777777777777777777777777777777777797n77n7n779pvv7777777777777777777777777puvf77
7779n9f777f9fvpvavuufvuupppppppppppppp77a9997upap7777777777777777777777777777777777a7a7777777apfa7777777777777777777777777puan77
77777777779n9vpfffvvv9vfppppppppppppppppppppppppp77777777777777777777777777777777777777777777npu7n777777777777777777777777pvva77
7777n7777n7aafp77n9f7nffpppppppppppppppuvuuauupuu777777777777777777777777777777777777777777777pv97777ppppppppppppppppppp77pf7777
777777777779aup77797n7avpppuuvuuvfuvuppffva9vupvv777777777777777777777777777777777777777777777pvf9777ppppppppppppppppppp77puv777
7777777777aaa9p7n777aa9vppp9nv7v9vvvapp99fna7vp9f777777777777777777777777777777777777777777777pvf7777pppppppppppppppppppv7pu9a77
77777777777naup77777nafvppp7nf7fa9fa7ppaaa9977p97777777777777777777777777777777777777777777777pf9a777pu9vuuvfvu9uv9n7uvp9fpua777
77777777777nnnp777777nfuppp77779na977pp7nnna77p77777777777777777777777777777777777777777777777pa9a777pvaavvfvfvvaaavf7npufpuv777
7777777777777up7777777vuppp77777777nvpp777n777p77777777777777777777777777777777777777777777777ppppppppvn999a77f9f777777pf7pafan7
77777777777nvup777777ffvppp77777777vvpppppppppp7777777777777777777777777777777777777777777777779ufuuu9uvf977777a7777777puvpvan77
777777777797a9p77777799uppp7777777ffvupuufvfuuv7777777777777777777777777777777777777777777777779avfv9a9777pppppppppppppppppvf977
777777777777aap77777a99fppp777777799fvpfvffvfvv777777777777777777777777777777777777777777777777a7n779aff77pppppppppppppppppu9na7
777777777779fvp777777afuppp7777777naavpf999naf77777777777777777777777777777777777777777777777777n7797n9777ppppppppppppppppp9f9a7
777777777779vuppppppppppppppppppppppppp7a77n77777777777777777777777777777777777777777777777777777n7a77n777pvfuvuv9aufa9pnvuv99an
7777777777af7upppppppppppppvuuuuf9uuuu77n7777n777777777777777777777777777777777777777777777777777777777777p99n7ff99avaapvn7777a7
777777777779fupppppppppppppfvvfna9faaa7777777n777777777777777777777777777777777777777777777777777777777777pu7777aaaan77pf9n9an77
77777777779f99fuvuu77fvuvv9a9ff7na9an777777777777777777777777777777777777777777777777777777777777777777777pv7777n7n77n7pvf977a77
777777777777aa9a9vf7vfvvffn999797aaa7777777777777777777777777777777777777777777777777777777777777777777777pu97777777777pva997777
777777777777nnf99797n9afa977nnaa777n7777777777777777777777777777777777777777777777777777777777777777777777pvfa777777777puvnaa777
777777777777a777a77797n9777777n777777777777777777777777777777777777777777777777777777777777777777777777777ppppppppppppppua9a7777
777777777777777777777n77777777777777777777777777777777777777777777777777777777777777777777777777777777777777uvvufvuvuaauunan7777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777vvvfaffan77nn77777
77777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777ffffa77nnn77777777
7777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777777n77797a7n7n77777777

